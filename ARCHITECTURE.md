# Архитектура образовательной системы BiGOR 2.0

## Обзор системы

Образовательная система BiGOR 2.0 представляет собой платформу для создания, управления и изучения образовательного контента с тремя основными типами пользователей:

1. **Редакторы курсов** - создают и управляют курсами
2. **Студенты** - изучают курсы и создают персональные коллекции
3. **Гости** - просматривают опубликованный контент без регистрации

## Архитектурные слои

### 1. Frontend Layer (Next.js 14)

- **App Router** - маршрутизация на основе файловой системы
- **React Components** - переиспользуемые UI компоненты
- **Tailwind CSS** - стилизация
- **BlockNote** - богатый текстовый редактор для создания контента

### 2. Backend Layer (Convex)

- **Database** - NoSQL база данных с автоматической синхронизацией
- **Functions** - серверные функции для бизнес-логики
- **Authentication** - интеграция с Clerk для аутентификации
- **File Storage** - EdgeStore для хранения файлов

### 3. External Services

- **Clerk** - аутентификация и управление пользователями
- **EdgeStore** - хранение файлов и изображений
- **Vercel** - хостинг и развертывание

## Структура базы данных

### Основные сущности:

#### 1. Documents (Документы)

- Базовые документы для создания контента
- Поддержка иерархической структуры
- Формулы и математические выражения

#### 2. Courses (Курсы)

- Метаданные курса (название, описание, категория)
- Связь с автором (редактором)
- Статус публикации и архивации

#### 3. Lectures (Лекции)

- Контент лекции (HTML)
- Связь с курсом
- Порядок в курсе
- Вложения и материалы

#### 4. Students (Студенты)

- Профиль студента
- Настройки и предпочтения
- Связь с Clerk пользователем

#### 5. StudentCollections (Коллекции студентов)

- Персональные коллекции лекций
- Публичные/приватные настройки
- Связь со студентом

#### 6. CollectionLectures (Связи коллекций и лекций)

- Связь между коллекцией и лекцией
- Порядок в коллекции

#### 7. CourseEnrollments (Записи на курсы)

- Отслеживание прогресса по курсам
- Статистика обучения

#### 8. LectureProgress (Прогресс по лекциям)

- Отслеживание завершения лекций
- Время, потраченное на изучение

#### 9. CourseViews (Просмотры курсов)

- Аналитика просмотров
- Поддержка гостевого доступа

## Модули системы

### 1. Модуль редакторов курсов (`/editor`)

- **Создание курсов** - интерфейс для создания новых курсов
- **Редактор лекций** - богатый текстовый редактор BlockNote
- **Управление контентом** - публикация, архивация, удаление
- **Аналитика** - статистика просмотров и популярности

### 2. Модуль гостевого доступа (`/public`)

- **Каталог курсов** - просмотр всех опубликованных курсов
- **Фильтрация** - по категориям, сложности, тегам
- **Просмотр лекций** - чтение контента без регистрации
- **Поиск** - поиск по названиям и описаниям

### 3. Модуль студентов (`/student`)

- **Профиль** - управление личными данными
- **Мои коллекции** - создание и управление коллекциями
- **Добавление лекций** - выбор лекций из опубликованных курсов
- **Прогресс обучения** - отслеживание изученного материала

## API Endpoints

### Courses API

- `GET /api/courses` - получение курсов
- `POST /api/courses` - создание курса
- `PUT /api/courses/:id` - обновление курса
- `DELETE /api/courses/:id` - удаление курса
- `POST /api/courses/:id/publish` - публикация курса

### Lectures API

- `GET /api/courses/:courseId/lectures` - получение лекций курса
- `POST /api/lectures` - создание лекции
- `PUT /api/lectures/:id` - обновление лекции
- `DELETE /api/lectures/:id` - удаление лекции

### Students API

- `GET /api/students/profile` - получение профиля
- `PUT /api/students/profile` - обновление профиля
- `GET /api/students/collections` - получение коллекций
- `POST /api/students/collections` - создание коллекции

### Collections API

- `GET /api/collections/:id/lectures` - получение лекций коллекции
- `POST /api/collections/:id/lectures` - добавление лекции
- `DELETE /api/collections/:id/lectures/:lectureId` - удаление лекции

## Безопасность

### Аутентификация

- Clerk для управления пользователями
- JWT токены для API запросов
- Роли пользователей (редактор, студент, гость)

### Авторизация

- Проверка прав доступа к курсам и лекциям
- Валидация владения контентом
- Защита приватных коллекций

### Валидация данных

- Zod схемы для валидации входных данных
- Санитизация HTML контента
- Проверка типов файлов для загрузки

## Производительность

### Оптимизация

- Индексы базы данных для быстрых запросов
- Пагинация для больших списков
- Кэширование статического контента
- Lazy loading компонентов

### Масштабируемость

- Serverless архитектура Convex
- Автоматическое масштабирование
- CDN для статических ресурсов
- Оптимизация изображений

## Мониторинг и аналитика

### Метрики

- Количество просмотров курсов
- Время, проведенное на лекциях
- Популярные категории и теги
- Активность пользователей

### Логирование

- Ошибки приложения
- Действия пользователей
- Производительность API
- Безопасность и доступы

## Развертывание

### CI/CD Pipeline

- Автоматическое тестирование
- Сборка и деплой на Vercel
- Миграции базы данных
- Мониторинг развертывания

### Окружения

- Development - локальная разработка
- Staging - тестовое окружение
- Production - продакшн окружение

## Технологический стек

### Frontend

- Next.js 14 (App Router)
- React 18
- TypeScript
- Tailwind CSS
- BlockNote (редактор)
- Lucide React (иконки)

### Backend

- Convex (база данных + функции)
- Clerk (аутентификация)
- EdgeStore (файловое хранилище)

### Инструменты разработки

- ESLint
- Prettier
- TypeScript
- Git

## Планы развития

### Краткосрочные цели

- Улучшение UI/UX
- Добавление тестов
- Оптимизация производительности
- Расширение функционала редактора

### Долгосрочные цели

- Мобильное приложение
- Интеграция с LMS
- AI-рекомендации
- Социальные функции
- Геймификация обучения
